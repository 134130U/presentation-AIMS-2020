# IPython log file

fname = "$HOME/Downloads/psp_swp_spc_l2i_20181102_v01.cdf"
from spacepy import pycdf
cdf = pycdf.CDF(fname)
t = cdf['Epoch'][:]
mv_lo = cdf['mv_lo'][:,:].T
mv_hi = cdf['mv_hi'][:,:].T
dcfd = cdf['diff_charge_flux_density'][:,:].T
t.shape
mv_lo.shape
mv_hi.shape
for arr in (mv_lo, mv_hi, dcfd):
    arr[arr == -1e31] = np.nan
    
V = (mv_hi + mv_lo) / 2
bad_data = np.any(~np.isfinite(V[:31,:]), axis=0)
bad_data.shape
bad_data.sum()
t = t[~bad_data]
V = V[:, ~bad_data]
dcfd = dcfd[:, ~bad_data]
import matplotlib.colors as colors
fig, ax = plt.subplots()
ax.pcolormesh(t[np.newaxis,:], V[:31,:], dcfd[:31,:], cmap=cm.plasma, norm=colors.LogNorm(vmin=1, vmax=dcfd[np.isfinite(dcfd)].max()))
ax.set_yscale('log')
fig.colorbar(ax.collections[0])
fig.autofmt_xdate()
fig.tight_layout()
get_ipython().run_line_magic('logstart', '/home/ross/repos/presentation-uofm-2020/devlogs/parker_probe.log')
exit()
